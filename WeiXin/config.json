{"sdkName":"WeiXin","className":"WeiXin.WeiXinSDK","useCustomJavaClass":true,"customJavaClass":[{"key":"WXEntryActivity","value":"package {PackageName}.wxapi;\r\n\r\nimport android.app.Activity;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport com.tencent.mm.opensdk.constants.ConstantsAPI;\r\nimport com.tencent.mm.opensdk.modelbase.BaseReq;\r\nimport com.tencent.mm.opensdk.modelbase.BaseResp;\r\nimport com.tencent.mm.opensdk.modelmsg.SendAuth;\r\nimport com.tencent.mm.opensdk.openapi.IWXAPIEventHandler;\r\nimport org.json.JSONObject;\r\n\r\nimport SdkInterface.LoginPlatform;\r\nimport SdkInterface.SDKInterfaceDefine;\r\nimport SdkInterface.SdkInterface;\r\nimport WeiXin.WeiXinSDK;\r\n\r\npublic class WXEntryActivity extends Activity implements IWXAPIEventHandler\r\n{\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState)\r\n    {\r\n        SdkInterface.SendLog(\"WXEntryActivity onCreate\");\r\n        super.onCreate(savedInstanceState);\r\n\r\n        Intent myIntent = getIntent();\r\n        myIntent.putExtra(\"wx_token_key\", \"com.tencent.mm.openapi.token\");\r\n        if(WeiXinSDK.api != null) {\r\n            WeiXinSDK.api.handleIntent(myIntent, this);\r\n        }\r\n\r\n        SdkInterface.SendLog(\"WXEntryActivity onCreate finish\");\r\n    }\r\n\r\n    public void onReq(BaseReq req) {\r\n        SdkInterface.SendLog(\"WX onReq \" + req.openId);\r\n    }\r\n    //\u7cfb\u7edf\u4e2d\u7684\u5fae\u4fe1\u4f5c\u51fa\u76f8\u5e94\u540e\u4f1a\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\r\n    public void onResp(BaseResp resp) {\r\n\r\n        SdkInterface.SendLog(\"WX onResp \" + resp.getType() + \" code: \" + resp.errCode);\r\n        try {\r\n            JSONObject jo = new JSONObject();\r\n            if (resp.getType()== ConstantsAPI.COMMAND_SENDAUTH  ) //\u767b\u5f55\r\n            {\r\n                SendAuth.Resp r = (SendAuth.Resp)resp;\r\n                String token = r.code;\r\n\r\n                //\u53d1\u56de\u7ed9SDKManager\r\n\r\n                jo.put(SDKInterfaceDefine.ModuleName,SDKInterfaceDefine.ModuleName_Login);\r\n                jo.put(SDKInterfaceDefine.Login_ParameterName_loginPlatform, LoginPlatform.WeiXin.toString());\r\n\r\n                if(resp.errCode==BaseResp.ErrCode.ERR_OK)//\u6210\u529f\r\n                {\r\n                    jo.put(SDKInterfaceDefine.ParameterName_IsSuccess,true);\r\n                    jo.put(SDKInterfaceDefine.Login_ParameterName_AccountId,token);\r\n                }\r\n                else  //\u5931\u8d25\r\n                {\r\n                    jo.put(SDKInterfaceDefine.ParameterName_IsSuccess,false);\r\n                    jo.put(SDKInterfaceDefine.Login_ParameterName_AccountId,token);\r\n                }\r\n\r\n                SdkInterface.SendMessage(jo);\r\n            }\r\n            //\u5206\u4eab\u7ed3\u679c\u7559\u7a7a\r\n            else if(resp.getType()==ConstantsAPI.COMMAND_SENDMESSAGE_TO_WX  ) //\u5206\u4eab\r\n            {\r\n                jo.put(SDKInterfaceDefine.ModuleName,SDKInterfaceDefine.ModuleName_Other);\r\n                SdkInterface.SendMessage(jo);\r\n            }\r\n\r\n        } catch (Exception e) {\r\n            SdkInterface.SendError(\"WX onResp error \" + e.toString(),e);\r\n        }\r\n        finish();\r\n    }\r\n}\r\n"},{"key":"WXPayEntryActivity","value":"package {PackageName}.wxapi;\r\n\r\nimport android.app.Activity;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.widget.Toast;\r\n\r\nimport com.tencent.mm.opensdk.constants.ConstantsAPI;\r\nimport com.tencent.mm.opensdk.modelbase.BaseReq;\r\nimport com.tencent.mm.opensdk.modelbase.BaseResp;\r\nimport com.tencent.mm.opensdk.openapi.IWXAPIEventHandler;\r\n\r\nimport org.json.JSONObject;\r\n\r\nimport SdkInterface.SDKInterfaceDefine;\r\nimport SdkInterface.SdkInterface;\r\nimport WeiXin.WeiXinSDK;\r\n\r\npublic class WXPayEntryActivity extends Activity implements IWXAPIEventHandler\r\n{\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        if(WeiXinSDK.api != null)\r\n        {\r\n            WeiXinSDK.api.handleIntent(getIntent(), this);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void onReq(BaseReq baseReq) {\r\n        SdkInterface.SendLog(\"WX Pay onReq :transaction: \" + baseReq.transaction + \" openId :\" + baseReq.openId);\r\n    }\r\n\r\n    @Override\r\n    public void onResp(BaseResp baseResp) {\r\n\r\n        SdkInterface.SendLog(\"WXPay onResp getType: \" + baseResp.getType() + \" transaction : \" + baseResp.transaction + \" openId \" + baseResp.openId);\r\n        try\r\n        {\r\n            if (baseResp.getType() == ConstantsAPI.COMMAND_PAY_BY_WX)\r\n            {\r\n                JSONObject jo = new JSONObject();\r\n                jo.put(SDKInterfaceDefine.ModuleName,SDKInterfaceDefine.ModuleName_Pay);\r\n                jo.put(SDKInterfaceDefine.Pay_ParameterName_GoodsID,\"Unknown\");\r\n                jo.put(SDKInterfaceDefine.Pay_ParameterName_CpOrderID,baseResp.transaction);\r\n                jo.put(SDKInterfaceDefine.Pay_ParameterName_OrderID,baseResp.openId);\r\n\r\n                if (baseResp.errCode == 0)\r\n                {\r\n                    jo.put(SDKInterfaceDefine.ParameterName_IsSuccess,true);\r\n                }\r\n                else\r\n                {\r\n                    jo.put(SDKInterfaceDefine.ParameterName_IsSuccess,false);\r\n                }\r\n\r\n                SdkInterface.SendMessage(jo);\r\n\r\n                if (baseResp.errCode == 0) {\r\n                    Toast.makeText(this, \"WXPay Success!\", Toast.LENGTH_SHORT).show();\r\n                    finish();\r\n                } else if (baseResp.errCode == -2) {\r\n                    Toast.makeText(this, \"WXPay Cancle!\", Toast.LENGTH_SHORT).show();\r\n                    finish();\r\n                } else {\r\n                    Toast.makeText(this, \"WXPay Error\", Toast.LENGTH_SHORT).show();\r\n                    finish();\r\n                }\r\n            }\r\n            else {\r\n                finish();\r\n            }\r\n        }\r\n        catch (Exception e)\r\n        {\r\n            SdkInterface.SendError(\"WXPay onResp error: \"+e.toString(),e);\r\n            finish();\r\n        }\r\n    }\r\n}\r\n"},{"key":"WeiXinSDK","value":"package WeiXin;\r\n\r\nimport com.tencent.mm.opensdk.modelmsg.SendAuth;\r\nimport com.tencent.mm.opensdk.modelpay.PayReq;\r\nimport com.tencent.mm.opensdk.openapi.IWXAPI;\r\nimport com.tencent.mm.opensdk.openapi.WXAPIFactory;\r\nimport com.unity3d.player.UnityPlayer;\r\n\r\nimport org.json.JSONObject;\r\nimport java.io.IOException;\r\n\r\nimport SdkInterface.*;\r\n\r\npublic class WeiXinSDK extends SDKBase implements ILogin,IPay,IOther\r\n{\r\n    public static  String AppID = \"\";\r\n    public static  String AppSecret =\"\";\r\n\r\n    public static IWXAPI api;\r\n\r\n    @Override\r\n    public void Init(JSONObject json) {\r\n\r\n        try {\r\n            AppID = GetProperties().getProperty(\"AppID\");\r\n            AppSecret = GetProperties().getProperty(\"AppSecret\");\r\n\r\n            api = WXAPIFactory.createWXAPI(UnityPlayer.currentActivity, WeiXinSDK.AppID);\r\n            api.registerApp(AppID);\r\n//            api.handleIntent(getIntent(), this);\r\n\r\n            SdkInterface.SendLog(\"WeiXinSDK Init: AppID \" + AppID + \" AppSecret \" + AppSecret);\r\n\r\n        } catch (IOException e)\r\n        {\r\n            SdkInterface.SendError(\"WeiXinSDK Init Error\" + e.toString(),e);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void Login(JSONObject json)\r\n    {\r\n        SdkInterface.SendLog(\"WeiXinSDK Login 1 AppID \" + AppID + \" AppSecret \" + AppSecret);\r\n\r\n        SendAuth.Req req = new SendAuth.Req();\r\n        req.scope = \"snsapi_userinfo\";\r\n        req.state = \"wechat_sdk_demo_test\";\r\n        api.sendReq(req);\r\n\r\n        SdkInterface.SendLog(\"WeiXinSDK Login 3 \");\r\n    }\r\n\r\n    @Override\r\n    public void Pay(JSONObject json)  {\r\n        SendLog(\"WX Pay \" + json.toString());\r\n        String prepayid = null;\r\n\r\n        try {\r\n            prepayid = json.getString(SDKInterfaceDefine.Pay_ParameterName_GoodsID);\r\n\r\n            PayReq request = new PayReq();\r\n            request.appId = WeiXinSDK.AppID;\r\n            request.partnerId = \"1526756671\"; \r\n            request.prepayId= prepayid; \r\n            request.packageValue = \"Sign=WXPay\";\r\n            request.nonceStr= \"111\"; \r\n            request.timeStamp= \"222\";\r\n            request.sign= \"333\";\r\n            api.sendReq(request);\r\n\r\n        } catch (Exception e) {\r\n            SendError(\"WX Pay Error \" + e.toString(),e);\r\n        }\r\n    }\r\n    \r\n    @Override\r\n    public void Other(JSONObject json) {\r\n\r\n    }\r\n\r\n    @Override\r\n    public String[] GetFunctionName() {\r\n        return new String[]{};\r\n    }\r\n}\r\n"}],"customJavaLibrary":["E:\\Project\\Library\\SDKLibrary\\WeiXin\\CompileLib\\android.jar","E:\\Project\\Library\\SDKLibrary\\WeiXin\\CompileLib\\classes.jar","E:\\Project\\Library\\SDKLibrary\\WeiXin\\CompileLib\\wechat-sdk-android-with-mta-5.1.6.jar","E:\\Project\\Library\\SDKLibrary\\Interface\\SDKInterface.jar"],"sdkType":"Login, Pay, Other","configList":[{"key":"AppID"},{"key":"AppSecret"}],"permissionList":["INTERNET","ACCESS_WIFI_STATE","READ_PHONE_STATE","WRITE_EXTERNAL_STORAGE","READ_LOGS","ACCESS_NETWORK_STATE"],"minSDKversion":0,"targetSDKVersion":0,"activityInfoList":[{"mainActivity":false,"name":"WXEntryActivity","content":"<activity android:name=\"{PackageName}.wxapi.WXEntryActivity\"\r\n  android:screenOrientation=\"landscape\"\r\n  android:configChanges=\"orientation|screenSize\"\r\n  android:exported=\"true\"\r\n  android:taskAffinity=\"net.sourceforge.simcpux\"\r\n  android:launchMode=\"singleTask\"\r\n  >\r\n</activity>\r\n"},{"mainActivity":false,"name":"WXPayEntryActivity","content":"<activity\r\n       android:name=\"{PackageName}.wxapi.WXPayEntryActivity\"\r\n       android:exported=\"true\"\r\n       android:launchMode=\"singleTop\"/>"}],"serviceInfoList":[],"providerInfoList":[]}